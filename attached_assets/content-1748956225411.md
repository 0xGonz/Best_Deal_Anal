Review of Deal Allocation Module Post-Investment

Content may be unverified or unsafe. [Report](https://openai.com/form/report-content/)

ChatGPTTry ChatGPT

[ChatGPT](https://chatgpt.com/?utm_src=deep-research-sharing)

# Review of Deal Allocation Module in _DealFlowLifecyclev1_

## Commitment and Capital Call Scenarios

After a deal is marked as **“invested”**, it must be allocated to at least one fund. The system supports multiple capital deployment scenarios for that allocation:

- **Commitment without Capital Called:** When a fund commitment is made to an invested deal but no capital has been drawn yet, the allocation remains in a “committed” state. In this scenario, no capital calls have been issued (total called amount = 0), and the system keeps the allocation status as **`committed`** [GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48). This allows a deal to be marked as invested while funds are committed but not yet requested from investors. The allocation record logs the commitment with an **allocation date** and other details (e.g. amount, security type) but shows zero capital called or paid.

- **Partial Capital Calls (Percentage or Dollar):** The module allows issuing capital calls for a portion of the commitment, specified either as a percentage of the commitment or a fixed dollar amount. The allocation’s **`amountType`** field captures whether the call is in percent or dollars, and a **`call_pct`** is stored for percentage calls[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/scripts/add-capital-call-constraints.ts#L70-L78). Each capital call entry records a **callDate** (when the call is issued) and a **dueDate** for payment[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L285-L293). If only part of the committed capital is called and/or paid, the system reflects this with partial statuses. For example, if some capital has been called but not fully paid, the allocation status updates to **`partially_paid`** [GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48). Internally, as payments come in, the capital call’s paid amount is updated and an outstanding balance is tracked. The code sets the capital call status to _“partially\_paid”_ when a payment is recorded that is less than the full call amount[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L350-L358). This ensures the system distinguishes a partially funded call from a fully paid one. All partial call and payment events are timestamped: the **paidDate** is recorded when payments are made, and the code normalizes this to noon UTC for consistency[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L442-L450). In summary, the module can handle scenarios like a 50% capital call (entered as 50% or the corresponding dollar amount) and later additional calls, while accurately logging each installment.

- **Full Capital Calls:** The module also supports drawing the entire committed amount via one or more calls. A **full capital call** scenario may occur in a single call (100% of commitment) or cumulatively after multiple calls. Once the total called amount equals the commitment and all called capital is paid by investors, the allocation status moves to **`funded`**, indicating the commitment is fully drawn[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48). The system logs the call details and marks the capital call(s) as **paid** with a final paid date. In the code, when a capital call’s outstanding amount goes to zero (meaning it’s fully paid), its status is updated to **`paid`**, and the allocation is automatically updated to **funded** if this was the last pending call for that allocation[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L386-L394). Each fully paid call carries a record of when the payment was completed (the paidDate) and sets the allocation’s final funding date accordingly. Thus, the “invested” deal’s allocation goes from _committed_ → _funded_ through the capital call process, with the system capturing each step.


Importantly, each of these scenarios is **logged with accurate dates**. The `fund_allocations` and `capital_calls` records include timestamps for creation and updates, and critical events (like capital call issuance and payments) carry dates. For example, the schema for capital calls includes fields for when the call was made and when it is due[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L285-L293), and payment entries include the payment date[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L13-L19). The system uses these fields to provide an audit trail of the investment lifecycle – from the allocation (commitment date) to each capital call (callDate) and the eventual payments (paidDate). By storing these timestamps and updating them on state changes, the module ensures that the timeline of fund deployment is recorded accurately for reporting and reference.

## Fund Tracking Integration (Called vs. Uncalled Capital)

The deal allocation module integrates tightly with the **fund tracking system** to reflect how much capital has been called and how much remains uncalled for each fund. Several mechanisms ensure consistency between deal allocations and fund-level metrics:

- **Commitment vs. Called Capital:** When an allocation is created (a fund commits to a deal), it increases the fund’s total **committed capital**. The code accumulates all active allocations to compute a fund’s committed capital[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L219-L227). Initially, if no capital is drawn, all of that commitment is categorized as **uncalled capital**. The fund service calculates **uncalled capital** as the difference between total commitments and the capital that has been called/paid[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L71-L79)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L80-L88). At this stage (allocation committed, no calls), called capital is $0 and uncalled equals the commitment.

- **Partial Calls and Payments:** As capital calls are issued and investors pay in capital, the system updates the fund’s **called capital** proportionally. The fund service’s logic sums up all **paid amounts** on capital calls associated with that fund to determine how much capital has actually been called (i.e. received)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L48-L56). Notably, it filters by allocation status and call status to count only effective draws – for example, an allocation in a partially paid state contributes its paid portion to called capital, whereas purely committed (no payment yet) does not[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L48-L56). This means if a deal’s allocation has, say, 50% paid in, that paid amount is reflected in the fund’s called capital, while the remaining 50% stays in uncalled. The uncalled capital metric then decreases accordingly. The integration here ensures that **partial funding** of an allocation is visible at the fund level: the fund’s called vs. uncalled figures adjust in real time as each payment arrives.

- **Full Funding:** Once an allocation is fully funded (all committed capital called and paid), the fund’s **called capital** for that allocation equals the allocation amount, and uncalled capital for that allocation becomes zero. The module marks the allocation as funded and, through the fund service, will count this entire amount in the fund’s called capital. The code explicitly updates an allocation’s status to `funded` when all its capital calls are paid[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L386-L394), which triggers the fund’s AUM (Assets Under Management) to update to include this amount. Essentially, when an allocation transitions to **funded**, the fund’s called capital increases to include the full commitment, and the uncalled capital is reduced by that commitment. This state is also persisted – the fund’s record has an **AUM** field that the system sets equal to the total called capital (see below), thereby storing the fully funded value[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L232-L240).

- **Automatic Updates to Fund Metrics:** The module automatically updates fund-level metrics whenever allocations or capital calls change state. For example, when an allocation is created or its status changes, the `AllocationService` triggers a recalculation of the fund’s AUM and portfolio weights[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L101-L110)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L125-L133). The `FundService.updateFundAUM` method recalculates the fund’s AUM by essentially setting it to the current called capital (summing all paid-in amounts)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L232-L240). This design means the fund’s record of called vs. uncalled capital is always in sync with the underlying allocations and payments. If a capital call is partially paid, the allocation status (once updated to partially\_paid) and the paidAmount on that call inform the fund’s next AUM calculation. In practice, the system will consider an allocation “partially\_paid” as soon as any payment is received and include those paid funds in the called capital tally[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L48-L56), while the rest stays uncalled. By contrast, if no payment has been made on an issued call, the allocation may still be treated as committed (until some amount is paid, per the status logic), and thus that amount remains in uncalled capital. This approach correctly differentiates between _capital that has merely been requested_ and _capital actually contributed_.

- **Portfolio Weight and Allocation Impact:** In addition to raw dollar figures, the integration covers how each deal allocation contributes to the fund’s portfolio composition. Whenever an allocation is added or updated, the system recalculates all allocations’ **portfolioWeight** within the fund[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L70-L79)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L82-L90). This weight is typically based on the commitment size relative to the total committed capital of the fund. By recalculating after each change, the module ensures that even if some allocations remain only committed while others become funded, the portfolio weighting (which the code bases on commitment by default) remains accurate and up-to-date. The weight recalculation ignores written-off deals and uses the committed amount as the basis[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L76-L84) – this is a design choice ensuring that the intended allocation size drives the portfolio percentage, not the timing of capital calls. That said, the **status** of allocations can still be used in reporting to highlight which parts of the portfolio are not yet funded versus fully funded.


In summary, the module’s integration with fund tracking means that **every stage of an allocation (committed, partially paid, fully funded)** is mirrored in fund-level summaries. Committed but uncalled capital is tracked, partially called capital is split between called and uncalled metrics, and fully called capital moves entirely into the fund’s called/AUM. All these updates happen through service-layer functions that recalc sums and update the database, rather than manual data entry, which reduces errors and keeps the deal and fund data consistent.

## Modular Design and Avoidance of Hardcoding

The deal allocation functionality is implemented in a **modular, service-oriented fashion**, which improves maintainability and scalability. Key aspects of the design avoid hardcoded, inflexible logic:

- **Service Layer Abstractions:** The repository defines dedicated service classes like `AllocationService`, `CapitalCallService`, and `FundService` that encapsulate related logic. For example, determining the allocation status based on payments is done in `AllocationService.updateAllocationStatus()` with clear business rules, rather than scattered conditional code in controllers[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L12-L20)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48). This centralization means any future changes (e.g. adding a new status or altering the criteria for “funded”) can be made in one place. Similarly, capital call state transitions and validations are handled in `CapitalCallService` methods, which makes the logic reusable (both the web API and any background jobs can use the same service functions).

- **Status Logic (No Magic Numbers):** The code avoids magic values by using enumerated status strings and computing state based on data. For instance, to decide an allocation’s status, the code **calculates totals** ( `totalCalledAmount` and `totalPaidAmount`) and then uses conditional logic to set the status[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48). It doesn’t assume, say, “two calls means partially paid” or other hardcoded thresholds – it derives the state from the actual amounts. Likewise, valid transitions for capital call statuses are defined in a mapping ( `VALID_STATUS_TRANSITIONS`) rather than hardcoded if/else chains[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L32-L40). This mapping explicitly lists which status can go to which next states, making it easy to extend or change without digging through complex conditional code. The `updateCapitalCallStatus` function then simply checks the map to validate a transition[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L426-L435). This approach is more scalable than embedding such rules inline, and it prevents illegal status changes by design.

- **Use of Shared Constants and Schema:** Many key values (status options, amount types, etc.) are defined in the shared schema or constants files. For example, the schema defines the allowed status strings for a fund allocation and capital call (such as `'committed'`, `'partially_paid'`, `'funded'`, etc.)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L200-L208)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L291-L298). By using these definitions throughout the code, the module avoids typos or mismatched strings that could occur if they were manually repeated. It also means adding a new status (e.g., a “closed” state) would be a matter of updating the schema and related logic in one go. There is minimal hardcoded numeric logic as well – even calculations like portfolio MOIC or IRR are computed when needed rather than fixed. The only numeric limits are sensible validations (e.g. the schema caps an allocation amount to $1 billion for safety[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L222-L225), and the UI uses step sizes for input fields) which are configurable or easy to adjust.

- **Trigger-Based Updates:** The module leans on **triggering functions** instead of hardcoding knowledge of other components. For instance, after creating or updating an allocation, the code calls out to recalculate portfolio weights and update the fund’s AUM[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L101-L110)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L125-L133). This is a modular pattern – the allocation service doesn’t need to know how weights are calculated or what AUM formula to use; it just invokes the responsible service ( `fundService.updateFundAUM`) to handle that. This decoupling means each piece (allocation logic, fund metrics, capital call management) can evolve independently as long as the interface (function calls) stays consistent. It avoids embedding fund calculation logic inside the allocation functions, which would be more rigid and harder to maintain. The presence of a storage factory ( `StorageFactory.getStorage()`) also abstracts whether data is coming from a database or in-memory cache[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/hybrid-storage.ts#L24-L32). This design indicates the code avoids hardcoding a specific persistence approach, making the system more robust (it can switch to a fallback storage if needed)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/hybrid-storage.ts#L38-L46).

- **Minimal Hardcoded Values:** Apart from structural constants, the codebase avoids hardcoded IDs or specific fund/deal names. The logic is written in a **scalable** way – e.g., iterating over all funds to update their allocations[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/allocations.ts#L80-L89), or computing percentages dynamically. Even something like the default **currency step** in the UI (e.g., stepping by $1,000 for dollar inputs) is a minor hardcoded value in the front-end[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/client/src/components/capitalcalls/CreateCapitalCallForm.tsx#L214-L222), not in the core logic, and can be easily changed for different granularity. There are no magic “50%” or “100%” values buried in the code to indicate partial or full calls – instead, the code calculates percentages or amounts as needed. The check for over-payment in a capital call, for example, uses the actual callAmount from the database to enforce that you can’t pay more than was called[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L321-L329)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L332-L340). This kind of rule is derived from data rather than an assumed constant, increasing the module’s flexibility (if call amounts vary widely or rules change, the code still holds).


Overall, the module’s structure – using services, shared schemas, and calculated logic – demonstrates good practices that avoid one-off hacks or rigid coding. This makes the deal allocation process easier to adjust as the business rules grow, and it isolates concerns (fund calculations vs. deal workflows, etc.) in a maintainable way.

## Lifecycle Integration Across Deal and Fund

This allocation module does not operate in isolation; it’s well-integrated into the broader **deal and fund lifecycle** in the system:

- **Pre-Investment Check:** The system design enforces that a deal cannot transition to the “invested” stage unless a fund allocation exists for it. In the deal service, when updating a deal’s stage to `invested`, a check runs to ensure there is at least one allocation linked to that deal[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L20-L23). This ensures that the act of marking a deal as invested is tied to actual fund commitments in the system – you’ve allocated resources from a fund to that deal. It prevents a situation where a deal is marked as invested (implying money spent) but no fund in the platform is actually investing in it, preserving data consistency between deal pipeline status and fund deployment.

- **Creating the Allocation (Deal → Fund):** When the allocation is created (typically around the time of investment approval), it establishes the relationship between the deal and the fund. The allocation includes the **fundId**, **dealId**, committed **amount**, type of investment (securityType), and an allocation date[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L194-L202). This insertion not only records the commitment but also triggers downstream updates – the module immediately recalculates portfolio weights and the fund’s AUM[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L101-L110). In practical terms, as soon as a deal enters the fund’s portfolio, the system updates the fund’s statistics to include this new asset. The allocation also acts as the anchor for all future capital calls: any capital call must reference the allocationId (linking back to both the deal and fund). This structured approach means the entire lifecycle – from deal to fund commitment to capital drawdowns – is connected through that allocation record.

- **Capital Calls and Deal Timeline:** Capital call events are integrated into the deal’s timeline and the fund’s records. Every capital call is linked via allocationId to a specific deal and fund, allowing the system to pull context (e.g., fund name or deal name) when needed[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L54-L62). Moreover, the module creates **timeline events** for key actions. For example, when a payment is added to a capital call, the code logs a timeline event on the deal (of type `capital_call_update`) with details like the amount paid, which fund/allocation it pertains to, and the new status of the call[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L540-L548)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L550-L558). This means that on the deal’s profile, one can see an audit trail of capital calls and payments – “Payment of $X added to capital call” – with timestamps. Similarly, the initial move to invested stage was recorded as a timeline event (deal moved to invested)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L186-L194)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L210-L217). These events ensure that the deal’s lifecycle is documented and can be reviewed in chronological order, linking the operational fund actions back to the high-level deal progression.

- **Cross-Module Data Flow:** Changes in one part of the lifecycle propagate appropriately. For instance, when investors fulfill a capital call (partial or full payment), not only does the capital call status change, but the allocation’s status may change (to partially\_paid or funded) and the fund’s called capital is updated. The system handles part of this propagation automatically: marking a call as paid will trigger an update that checks all calls for that allocation, and if everything is paid, marks the allocation funded[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L378-L386)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L387-L395). In cases of partial payment, the allocationService’s `updateAllocationStatus` can be invoked to mark the allocation as partially\_paid and keep the statuses in sync[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L42-L48). Furthermore, because the fund AUM is recomputed based on actual payments, once a payment is logged, the fund’s metrics (called/uncalled) adjust on the next computation cycle. There is a conscious effort to **avoid stale data**: for example, the code invalidates cached data after certain updates to ensure the UI fetches fresh information[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L396-L400). All of this means the deal-fund lifecycle remains consistent – if a deal is invested and 25% funded, anyone looking at the deal or the fund will see corresponding reflections of that state (deal timeline shows partial funding events, fund shows 25% capital called, allocation status says partially\_paid).

- **End-to-End Scenario:** To illustrate the integration, consider an end-to-end flow: A deal moves through diligence and is approved by investment committee. The user allocates $1M from **Fund A** to this deal (creates an allocation record). Immediately, Fund A’s committed capital increases by $1M, and the deal can now be marked as invested (passess the allocation check)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L20-L23). On marking as invested, a timeline event notes this. Next, the fund managers issue a capital call for 50% of that allocation. They use the UI to create a capital call with amountType “percentage” = 50%, and the system computes that as a $500k call (storing call\_pct=50 and callAmount=500000, for instance). This call has a callDate and dueDate recorded[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L285-L293). No capital is paid yet, so the allocation still shows as committed (since totalPaid=0) but now has an outstanding call. If the LPs pay $300k of the call by the due date (a partial payment), the user records this payment. The system then updates the capital call: paidAmount=300k, outstanding=200k, status= `partially_paid` [GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L344-L353). It also creates a timeline event on the deal about this payment[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L540-L548). Now the allocation’s status can be considered **partially\_paid** (reflecting that some money arrived)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L42-L48), and Fund A’s called capital increases by $300k while uncalled decreases by the same. Finally, when the remaining $200k is paid, the capital call becomes fully `paid` and the allocation status flips to **funded** [GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L386-L394). Fund A’s called capital becomes $1M (fully called), uncalled for that allocation is $0, and the fund’s AUM now reflects the full $1M drawn[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L232-L240). Another timeline entry is added for the final payment. Throughout this process, each module (deal, allocation, capital call, fund) communicated through the shared identifiers and service calls to keep all pieces updated. A stakeholder can look at the deal’s detail page and see each capital call and payment event with dates, and look at the fund’s page to see how much of that $1M commitment is still unfunded at any given time. This cohesive flow confirms that the allocation module is properly **woven into the overall lifecycle** of deals and funds.


## Issues and Suggestions for Improvement

While the deal allocation module is robust, the review did identify a few areas for potential improvement or clarification:

- **Allocation Status on Partial Payments:** One issue is that the allocation’s status isn’t immediately updated to `partially_paid` when a partial payment is made, unless explicitly recalculated. The logic to set an allocation as **partially\_paid** exists (based on any paidAmount > 0 and not fully paid)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L42-L48), but in the current flow, it appears this function needs to be called to take effect. In the capital call payment handling, the code directly marks an allocation as funded when fully paid[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L386-L394), yet for partial payments the allocation might remain marked as “committed” until a manual or scheduled update runs. This could lead to a discrepancy where an allocation has some paid capital but is not labeled partially\_paid in the database. The **suggestion** is to invoke the allocation status update routine whenever a payment is recorded (not just on full funding). Ensuring that, immediately after the first payment on a call, the allocation status flips to partially\_paid (and triggers the usual weight/AUM recalculations) would more accurately reflect the state and avoid any lag in fund metrics. This could be done by calling `allocationService.updateAllocationStatus(allocationId)` after recording a payment or by extending the capital call service’s payment logic to handle the partial status case similarly to the full case.

- **Consistency in Status Terminology:** There is a bit of confusion in the code between `'partial'` and `'partially_paid'` statuses for capital calls. Both appear in the allowed status enums[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L291-L298) and transition maps[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L34-L39), but their usage overlaps. The code path for adding a payment uses `'partially_paid'` to indicate a call that’s been partially satisfied[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L350-L358), whereas the manual status update function allowed a transition to `'partial'` for a similar idea[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L450-L459). It seems `'partial'` and `'partially_paid'` are intended to represent the same concept (a call not fully paid yet), or at least very similar concepts. This dual terminology could be simplified – for example, standardize on one term for calls in progress versus completed. The presence of both could confuse future developers or lead to edge-case bugs (e.g., if one part of the UI sets a call to “partial” and another expects “partially\_paid”). **Improvement:** Consolidate these into one status. If needed, use `'called'` for issued-not-paid, and `'partially_paid'` for issued-and-partially-paid, eliminating the `'partial'` label. Updating the transition map and code accordingly would make the state machine easier to follow. At minimum, documenting the distinction clearly and ensuring all code paths handle both consistently will prevent logic from slipping through the cracks.

- **Data Redundancy in Payments:** The module currently records payments in two places – a general `payments` table (via raw SQL insertion) and the `capital_call_payments` table via the storage API[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L326-L335)[GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L333-L341). While this was likely done “for backwards compatibility,” maintaining two parallel records for the same payment can introduce inconsistencies. For instance, if one insertion succeeds and the other fails, or if future code reads from one table while another part reads from the other, data may become out of sync. To enhance reliability, it would be better to unify payment tracking. The suggestion is to eventually deprecate one of these tables (probably the older `capital_call_payments`) and use a single source of truth for all payment entries. The general `payments` table with a capital\_call\_id and amount might be the intended long-term solution for simplicity (and could be extended with type/notes fields if needed). Until then, ensuring both records are always updated identically (perhaps by wrapping the dual-write in a transaction) is important. Reducing this redundancy will make the system easier to maintain and avoid confusion about where to look for payment history.

- **Automatic Triggers vs. Manual Recalculation:** Currently, the system relies on calling the appropriate service methods after certain events (e.g., after creating a capital call, after updating a status) to keep everything in sync. If any of these calls were missed, data could drift. One improvement could be an **event-driven architecture** or database triggers to guarantee updates. For example, an event (“CapitalCallPaid”) could trigger allocation status updates and fund metric updates automatically, decoupling the timing from the UI or route calls. Similarly, if multiple partial payments come in, an event for each payment could ensure the allocation and fund are recalculated each time. This would provide extra safety so that even if a developer forgets to call one update function, the system’s eventual consistency is maintained. Given the current size of the system, the explicit service calls work, but as it grows, moving to a more declarative update scheme could help.

- **Minor Hardcoded Values:** As noted, the core logic avoids hardcoding, but a few minor values could be made configurable. For example, the default assumption that a _fund’s total size = sum of allocations_ [GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L242-L249) or that **AUM equals called capital** [GitHub](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L232-L240) might not hold if the business logic changes (say, including market value changes). While currently correct for committed vs. called tracking, if, in the future, “AUM” is defined differently, that calculation would need adjustment. It’s less a flaw and more a design note: the module should continue to be reviewed as business definitions evolve. Parameters like the maximum commitment size (1e9 in the schema) or default capital call percentage steps (1% increments in UI) could be moved to config files to avoid code changes if those limits need to change. These are relatively small issues, and the code is already written clearly enough that such adjustments are straightforward.


In conclusion, the deal allocation module is generally well-designed and fulfills its role in the system. Addressing the above points would iron out some edge cases and future-proof the system. Ensuring partial payments immediately reflect in allocation status and fund metrics, streamlining status nomenclature, and cleaning up data models will make the module even more accurate and maintainable. With these improvements, the logic will remain solid even as the platform scales up its number of deals, funds, and investors.

Citations

[![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
add-capital-call-constraints.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/scripts/add-capital-call-constraints.ts#L70-L78](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/scripts/add-capital-call-constraints.ts#L70-L78) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
schema.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L285-L293](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L285-L293) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L350-L358](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L350-L358) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L442-L450](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L442-L450) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L386-L394](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L386-L394) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
schema.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L13-L19](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L13-L19) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
fund.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L219-L227](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L219-L227) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
fund.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L71-L79](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L71-L79) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
fund.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L80-L88](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L80-L88) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
fund.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L48-L56](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L48-L56) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
fund.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L232-L240](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L232-L240) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L101-L110](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L101-L110) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L125-L133](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L125-L133) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L70-L79](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L70-L79) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L82-L90](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L82-L90) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L76-L84](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L76-L84) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L12-L20](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L12-L20) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L32-L40](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L32-L40) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L426-L435](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L426-L435) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
schema.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L200-L208](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L200-L208) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
schema.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L291-L298](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L291-L298) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
schema.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L222-L225](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L222-L225) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
hybrid-storage.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/hybrid-storage.ts#L24-L32](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/hybrid-storage.ts#L24-L32) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
hybrid-storage.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/hybrid-storage.ts#L38-L46](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/hybrid-storage.ts#L38-L46) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocations.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/allocations.ts#L80-L89](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/allocations.ts#L80-L89) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
CreateCapitalCallForm.tsx\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/client/src/components/capitalcalls/CreateCapitalCallForm.tsx#L214-L222](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/client/src/components/capitalcalls/CreateCapitalCallForm.tsx#L214-L222) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L321-L329](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L321-L329) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L332-L340](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L332-L340) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
DealService.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L20-L23](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L20-L23) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
schema.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L194-L202](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/shared/schema.ts#L194-L202) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-calls.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L54-L62](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L54-L62) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-calls.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L540-L548](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L540-L548) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-calls.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L550-L558](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/routes/capital-calls.ts#L550-L558) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
DealService.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L186-L194](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L186-L194) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
DealService.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L210-L217](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/DealService.ts#L210-L217) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L378-L386](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L378-L386) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L387-L395](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L387-L395) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
allocation.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L42-L48](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L42-L48) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L396-L400](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L396-L400) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L344-L353](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L344-L353) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L34-L39](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L34-L39) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L450-L459](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L450-L459) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L326-L335](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L326-L335) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
capital-call.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L333-L341](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/capital-call.service.ts#L333-L341) [![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
fund.service.ts\\
\\
https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L242-L249](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/fund.service.ts#L242-L249)

All Sources

[![Favicon](https://www.google.com/s2/favicons?domain=https://github.com&sz=32)\\
\\
github](https://github.com/0xGonz/DealFlowLifecyclev1/blob/fab91cce07e2ca78f995d39502c377b71748ec6f/server/services/allocation.service.ts#L40-L48)